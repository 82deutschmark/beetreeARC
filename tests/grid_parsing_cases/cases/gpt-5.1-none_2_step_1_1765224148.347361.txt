First, I’ll describe the pattern and transformation in the examples, then apply it carefully to the test input.

---

## 1. Understanding the Base Pattern

Look at the “background” that appears in all three inputs:

- Color 8 forms borders, blocks, and stripes.
- Color 0 is the background within holes or gaps.
- There is a repeating inner pattern of 8s and 0s that appears in many rows:

For example, this 16‑cell pattern (from Example 2 row 2 and many others):

`8,8,0,0,8,8,8,0,0,8,8,8,0,0,8,8`

Rows that are “pure background” in the outputs keep this pattern unchanged.

So the global structure is a fixed, repeating background pattern of 8s and 0s, sometimes bordered by 8s or 0s.

---

## 2. Effect of Special Colors (Non‑0/8 Colors)

The interesting changes in the outputs occur around cells whose values are not 0 or 8:

- Example 1 has a `4` at (row 11, col 1).
- Example 2 has `7` at (row 1, col 0), `1` at (row 5, col 10), and `4` at (row 10, col 5).

In each example, the output introduces a 4×4 block of that same color “inserted” into the background grid at a specific region that corresponds to the row/column “block” where the special color sits.

### 2.1 Block structure

The large grid is partitioned into 4×4 “tiles” within the central region:

- In Example 2 (16×16), you really see a 4×4 of tiles, each tile is 4×4 cells:
  - For color 7, the original 7 is at the upper‑left tile. In the output, that tile’s interior 2×2 cells become 7, and the 4×4 boundary is adapted to still match the surrounding pattern of 8s and 0s.
  - Same pattern for 1 and 4 in Example 2: each non‑8/0 color produces a 4×4 tile where the inner 2×2 is that color, bordered by 8s to stitch into the global pattern.

- In Example 1 (21 columns × 16 rows), you see a similar idea, but horizontally there is a repetition of that 16‑wide pattern plus an extra 5 columns; vertically also divided into 4‑row tiles. The 4 colors are placed in certain tile(s); then each such tile is “activated” into a 4×4 motif of that color, overriding interior 0s/or changing some 8s, while preserving outer edges of the global pattern.

Key observation:  
The special colors are not *just* left in their original cell; instead, a 4×4 block anchored at that tile location is filled according to a fixed pattern: a surrounding ring of 8s and a 2×2 center of the special color, except that where that ring sits on the tile boundary it must be consistent with the external pattern (so some outer cells remain as they were).

Concretely, in Example 2:

- Original 7 at (0,0).  
  Output rows 1–4, cols 2–5 become:

  ```
  row1: 8,8,7,7
  row2: 7,7,7,7
  row3: 7,7,7,7
  row4: 8,8,7,7
  ```
  
  That is a 4×4 diamondish block of 7s (a solid 4×4 minus some edge 8s where vertically adjacent background rows are 8). But the pattern is still a 4×4 block strongly dominated by the special color in the center.

For the “1” in Example 2:

- Original 1 at (5,10).  
  Output around rows 7–10, cols 12–15:

  ```
  row7: ..., 1,1,8,8
  row8: ..., 1,1,1,1
  row9: ..., 1,1,1,1
  row10: ...,1,1,8,8
  ```

Again, a 4×4 dominated by the new color, with 8s on part of the top or right border.

For the “4” in Example 2:

- Original 4 at (10,5).  
  Output around rows 12–15, cols 7–10:

  ```
  row12: ..., 4,4,8,8
  row13: ..., 4,4,4,4
  row14: ..., 4,4,4,4
  row15: ..., 4,4,8,8
  ```

Same type of 4×4.

In Example 1, the 4 at roughly the middle of a repeating motif similarly triggers a 4×4 block of 4s in the output.

So the *transformation rule* is:

- Ignore background 8 and 0.
- For each non‑8/0 color c found in the input, identify its 4×4 tile in the global pattern.
- Replace that tile with a 4×4 motif that introduces c in a 2×2 center and expands to a 4×4 mass of c with 8 at some outer cells so the pattern aligns with its neighbors.

---

## 3. Applying to the Test Input

Now examine the test input.

The grid is 21 rows × 16 columns. Let’s scan for any non‑8/0 colors:

Inspecting each row:

Row 1: `8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0` → only 8 and 0.

Row 2–5: all 8s and 0s.

Row 6:  
`8,8,8,8,8,1,8,8,8,8,8,8,8,8,8,0`  
There is a single `1` at (row 6, col 5) (0‑based indexing: r=5, c=5).

Rows 7–15: only 8s and 0s, in the same repeating pattern.

Rows 16–21: these correspond to the bottom repeated region of Example 2/1; again only 8 and 0.

So there is exactly one special color in the test input: `1` at (6,5) (1‑based: row 6, column 6).

We must now insert the 4×4 motif for color 1 at the corresponding tile.

Compare with Example 2:

- In Example 2, `1` appears in row 6, column 11 (1‑based). In the output, the 4×4 block of 1s is centered starting two rows below and two columns right of that, so it occupies rows 8–11, columns 13–16 (1‑based). That is, the motif is shifted by (+2 rows, +2 columns) relative to the original colored cell.

Check: original 1 at (6,11); motif’s top‑left at (8,13). That is indeed +2 row, +2 col.

So we apply the same offset to the test case:

- Test `1` at (6,6) (1‑based).  
- Motif top‑left = (6+2, 6+2) = (8,8) (1‑based).

Thus the 4×4 block for color 1 occupies rows 8–11, columns 8–11 (1‑based).

Convert to 0‑based indices:

- Rows 7,8,9,10
- Columns 7,8,9,10

Now, pattern inside this 4×4: we follow the same template as in Example 2:

For 1 in Example 2, the 4×4 block (rows 8–11, cols 13–16) was:

- row8: 1,1,8,8
- row9: 1,1,1,1
- row10: 1,1,1,1
- row11: 1,1,8,8

So pattern is:

Row relative 0: [1,1,8,8]  
Row relative 1: [1,1,1,1]  
Row relative 2: [1,1,1,1]  
Row relative 3: [1,1,8,8]

We use the same pattern here:  
apply that to rows 8–11, cols 8–11 (1‑based).

---

### 3.1 Compute Background Before Insertion

Let’s write rows 8–11 of the test input with column indices (1‑based):

Row 8:  
`8,0,0,0,0,8,0,0,0,0,8,0,0,0,0,8`  
Cols 1..16

Row 9:  
`8,0,0,0,0,8,0,0,0,0,8,0,0,0,0,8`

Row 10:  
`8,8,0,0,8,8,8,0,0,8,8,8,0,0,8,8`

Row 11:  
`8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0`

We now modify columns 8–11 in these 4 rows:

- Affected positions (1‑based):

  - Row 8: cols 8,9,10,11 → currently `0,0,8,0`
  - Row 9: cols 8,9,10,11 → `0,0,8,0`
  - Row10: cols 8,9,10,11 → `0,0,8,8`
  - Row11: cols 8,9,10,11 → `8,8,8,8`

Apply 4×4 motif:

Row 8 (relative row 0): replace (c8..c11) with [1,1,8,8]:

- becomes: `8,0,0,0,0,8,0,1,1,8,8,0,0,0,0,8`

Row 9 (relative row 1): replace (c8..c11) with [1,1,1,1]:

- becomes: `8,0,0,0,0,8,0,1,1,1,1,0,0,0,0,8`

Row 10 (relative row 2): replace (c8..c11) with [1,1,1,1]:

- original row10: `8,8,0,0,8,8,8,0,0,8,8,8,0,0,8,8`
- after: `8,8,0,0,8,8,8,1,1,1,1,8,0,0,8,8`

Row 11 (relative row 3): replace (c8..c11) with [1,1,8,8]:

- original row11: `8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0`
- after: `8,8,8,8,8,8,8,1,1,8,8,8,8,8,8,0`

All other rows remain identical to input; we don’t change the original 1 at row 6, col 6 in this pattern (as evidenced by Example 2: the original special cell is not removed or recolored; in Example 2, the original 1 at row6,col11 stays as 1 in the output).

So we also keep row 6 intact.

---

## 4. Final Output Grid

Now I list the entire 21×16 output grid row by row.

Row 1 (unchanged):  
`8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,0`

Row 2:  
`8,8,0,0,8,8,8,0,0,8,8,8,0,0,8,8`

Row 3:  
`8,0,0,0,0,8,0,0,0,0,8,0,0,0,0,8`

Row 4:  
`8,0,0,0,0,8,0,0,0,0,8,0,0,0,0,8`

Row 5:  
`8,8,0,0,8,8,8,0,0,8,8,8,0,0,8,8`

Row 6 (with original 1 preserved):  
`8,8,8,8,8,1,8,8,8,8,8,8,8,8,8,0`

Row 7:  
`8,8,0,0,8,8,8,0,0,8,8,8,0,0,8,8`

Row 8 (modified):  
`8,0,0,0,0,8,0,1,1,8,8,0,0,0,0,8`

Row 9 (modified):  
`8,0,0,0,0,8,0,1,1,1,1,0,0,0,0,8`

Row 10 (modified):  
`8,8,0,0,8,8,8,1,1,1,1,8,0,0,8,8`

Row 11 (modified):  
`8,8,8,8,8,8,8,1,1,8,8,8,8,8,8,0`

Row 12 (unchanged below):  
`8,8,0,0,8,8,8,0,0,8,8,8,0,0,8,8`

Row 13:  
`8,0,0,0,0,8,0,0,0,0,8,0,0,0,0,8`

Row 14:  
`8,0,0,0,0,8,0,0,0,0,8,0,0,0,0,8`

Row 15:  
`8,8,0,0,8,8,8,0,0,8,8,8,0,0,8,8`

Row 16:  
`0,8,8,8,8,0,8,8,8,8,0,8,8,8,8,0`

Row 17:  
`8,8,0,0,8,8,8,0,0,8,8,8,0,0,8,8`

Row 18:  
`8,0,0,0,0,8,0,0,0,0,8,0,0,0,0,8`

Row 19:  
`8,0,0,0,0,8,0,0,0,0,8,0,0,0,0,8`

Row 20:  
`8,8,0,0,8,8,8,0,0,8,8,8,0,0,8,8`

Row 21:  
`0,8,8,8,8,0,8,8,8,8,0,8,8,8,8,0`